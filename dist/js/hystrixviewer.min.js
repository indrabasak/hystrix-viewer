var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(e,b,d){if(null==e)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return e+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,d){e!=Array.prototype&&e!=Object.prototype&&(e[b]=d.value)};$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(e,b,d,k){if(b){d=$jscomp.global;e=e.split(".");for(k=0;k<e.length-1;k++){var l=e[k];l in d||(d[l]={});d=d[l]}e=e[e.length-1];k=d[e];b=b(k);b!=k&&null!=b&&$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(e){return e?e:function(b,d){var e=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var l=e.length,f=b.length;d=Math.max(0,Math.min(d|0,e.length));for(var h=0;h<f&&d<l;)if(e[d++]!=b[h++])return!1;return h>=f}},"es6-impl","es3");
(function(e,b,d){function k(g,e,c){this.circuitDivId=void 0;this.circuitKey=g;this.serviceName=e;this.methodName=c;this.suffix=this.serviceName+"_"+this.methodName;this.initialized=!1;this.graphDivId=this.chartDivId=void 0;this.data={};this.graphData=[];this.render=function(){if(!this.initialized){this.circuitDivId="CIRCUIT_"+this.suffix;var a=b("<div></div>").attr("id",this.circuitDivId).addClass("monitor").css({position:"relative"});b("#"+r).append(a);this.addChart(a);this.addTitle(a);this.addData(a);
this.addSparkline(a);this.initialized=!0}};this.refresh=function(a){this.preProcessData(a);this.render();this.updateCircle();this.updateData();this.updateSparkline()};this.addChart=function(a){this.chartDivId="chart_CIRCUIT_"+this.suffix;var c=b("<div></div>").attr("id",this.chartDivId).addClass("chart").css({position:"absolute",top:"0px",left:"0","float":"left",width:"100%",height:"100%"});a.append(c);this.addCircle(this.chartDivId)};this.addCircle=function(a){d.select("#"+a).append("svg:svg").attr("width",
"100%").attr("height","100%").append("svg:circle").style("fill","green").attr("cx","30%").attr("cy","30%").attr("r",5)};this.updateCircle=function(){var a=v(this.data.ratePerSecondPerHost);parseInt(a,10)>parseInt("40%",10)&&(a="40%");var c=w(this.data.ratePerSecondPerHost);parseInt(c,10)>parseInt("40%",10)&&(c="40%");var b=x(this.data.ratePerSecondPerHost);125<parseInt(b,10)&&(b="125");d.selectAll("#"+this.chartDivId+" circle").transition().duration(400).attr("cy",c).attr("cx",a).attr("r",b).style("fill",
y(this.data.errorPercentage))};this.addTitle=function(a){var c='<p class="name"'+this.serviceName+"."+this.methodName+">"+this.serviceName+"."+this.methodName+"</p>",c=b("<div></div>").css({position:"absolute",top:"0px",width:"100%",height:"15px",opacity:"0.8",background:"white"}).html(c);a.append(c)};this.addData=function(a){var c=b("<div></div>");b(c).css({position:"absolute",top:"15px",opacity:"0.8",background:"white",width:"100%",height:"95%"});a.append(c);a=b("<div></div>").attr("id","chart_CIRCUIT_"+
this.suffix+"_monitor_data").addClass("monitor_data");c.append(a)};this.updateData=function(){if(this.initialized){var a=b("#chart_CIRCUIT_"+this.suffix+"_monitor_data");a.empty();this.addCounters(a);this.addRate(a);this.addDataTable(a)}};this.addCounters=function(a){var c=b("<div></div>").addClass("counters");a.append(c);a=b("<div></div>").addClass("cell line").html('<a href="javascript://" title="Error Percentage [Timed-out + Threadpool Rejected + Failure / Total]"class="hystrix-tooltip errorPercentage"><span class="value">'+
this.data.errorPercentage+"</span>%</a>");c.append(a);a='<a href="javascript://" title="Timed-out Request Count"class="line hystrix-tooltip timeout"><span class="value">'+this.data.rollingCountTimeout+"</span></a>";var d=this.data.rollingCountThreadPoolRejected?'<a href="javascript://" title="Threadpool Rejected Request Count"class="line hystrix-tooltip rejected"><span class="value">'+this.data.rollingCountThreadPoolRejected+"</span></a>":'<a href="javascript://" title="Semaphore Rejected Request Count"class="line hystrix-tooltip rejected"><span class="value">'+
this.data.rollingCountSemaphoreRejected+"</span></a>";var g='<a href="javascript://" title="Failure Request Count"class="line hystrix-tooltip failure"><span class="value">'+this.data.rollingCountFailure+"</span></a>";a=b("<div></div>").addClass("cell borderRight").html(a+"\n"+d+"\n"+g);c.append(a);a='<a href="javascript://" title="Successful Request Count"class="line hystrix-tooltip success"><span class="value">'+this.data.rollingCountSuccess+"</span></a>";d='<a href="javascript://" title="Short-circuited Request Count"class="line hystrix-tooltip shortCircuited"><span class="value">'+
this.data.rollingCountShortCircuited+"</span></a>";g='<a href="javascript://" title="Bad Request Count"class="line hystrix-tooltip badRequest"><span class="value">'+this.data.rollingCountBadRequests+"</span></a>";a=b("<div></div>").addClass("cell borderRight").html(a+"\n"+d+"\n"+g);c.append(a)};this.addRate=function(a){var c='<a href="javascript://" title="Total Request Rate per Second per Reporting Host"class="hystrix-tooltip rate"><span class="smaller">Host: </span><span class="ratePerSecondPerHost">'+
this.data.ratePerSecondPerHost+"</span>/s</a>",c=b("<div></div>").addClass("rate").html(c);a.append(c);c='<a href="javascript://" title="Total Request Rate per Second for Cluster"class="hystrix-tooltip rate"><span class="smaller">Cluster: </span><span class="ratePerSecond">'+this.data.ratePerSecond+"</span>/s</a>";c=b("<div></div>").addClass("rate").html(c);a.append(c)};this.addCircuitStatus=function(a){var c=b("<div></div>").addClass("circuitStatus");a.append(c)};this.addDataTable=function(a){var c=
b("<div></div>").addClass("spacer");a.append(c);c=b('<div class="tableRow"><div class="cell header">Hosts</div><div class="cell data">'+this.data.reportingHosts+' </div><div class="cell header">90th</div><div class="cell data latency90"><span class="value">'+this.data.latency90+"</span>ms </div></div>");a.append(c);c=b('<div class="tableRow"><div class="cell header">Median</div><div class="cell data latencyMedian"><span class="value">'+this.data.latencyMedian+'</span>ms </div><div class="cell header">99th</div><div class="cell data latency99"><span class="value">'+
this.data.latency99+"</span>ms </div></div>");a.append(c);c=b('<div class="tableRow"><div class="cell header">Mean</div><div class="cell data latencyMean"><span class="value">'+this.data.latencyMean+'</span>ms</div><div class="cell header">99.5th</div><div class="cell data latency995"><span class="value">'+this.data.latency995+"</span>ms</div></div>");a.append(c)};this.addSparkline=function(a){this.graphDivId="graph_CIRCUIT_"+this.suffix;var c=b("<div></div>").attr("id",this.graphDivId).addClass("graph").css({position:"absolute",
top:"25px",left:"0","float":"left",width:"140px",height:"62px"});a.append(c);d.select("#"+this.graphDivId).append("svg:svg").attr("width","100%").attr("height","100%").append("svg:path")};this.updateSparkline=function(){var a=(new Date).getTime();for(this.graphData.push({v:parseFloat(this.data.ratePerSecond),t:a});200<this.graphData.length;)this.graphData.shift();if(1!==this.graphData.length||0!==this.graphData[0].v){1<this.graphData.length&&0===this.graphData[0].v&&0!==this.graphData[1].v&&this.graphData.shift();
var c=d.scaleTime().domain([new Date(a-12E4),new Date(a)]).range([0,140]),a=d.min(this.graphData,function(a){return a.v}),b=d.max(this.graphData,function(a){return a.v}),g=d.scaleLinear().domain([a,b]).nice().range([60,0]),e=d.line().x(function(a){return c(new Date(a.t))}).y(function(a){return g(a.v)}).curve(d.curveBasis),f=this.graphData;d.selectAll("#"+this.graphDivId+" path").attr("d",function(a,c){return e(f)})}};this.preProcessData=function(a){this.data={};var c=f(a,this.circuitKey+".propertyValue_metricsRollingStatisticalWindowInMilliseconds",
0)/1E3,b=f(a,this.circuitKey+".requestCount",0);0>b&&(b=0);var g=f(a,this.circuitKey+".reportingHosts",0);this.data.ratePerSecond=h(b/c);this.data.ratePerSecondPerHost=h(b/c/g);this.data.ratePerSecondPerHostDisplay=this.data.ratePerSecondPerHost;this.data.errorPercentage=f(a,this.circuitKey+".errorPercentage",0);this.data.rollingCountTimeout=f(a,this.circuitKey+".rollingCountTimeout",0);c=f(a,this.circuitKey+".rollingCountThreadPoolRejected",-20);-20===c?this.data.rollingCountSemaphoreRejected=f(a,
this.circuitKey+".rollingCountSemaphorePoolRejected",0):this.data.rollingCountThreadPoolRejected=c;this.data.rollingCountFailure=f(a,this.circuitKey+".rollingCountFailure",0);this.data.rollingCountSuccess=f(a,this.circuitKey+".rollingCountSuccess",0);this.data.rollingCountShortCircuited=f(a,this.circuitKey+".rollingCountShortCircuited",0);this.data.rollingCountBadRequests=f(a,this.circuitKey+".rollingCountBadRequests",0);this.data.reportingHosts=f(a,this.circuitKey+".reportingHosts",1);this.data.latency90=
f(a,this.circuitKey+".90",0);this.data.latencyMedian=f(a,this.circuitKey+".50",0);this.data.latency99=f(a,this.circuitKey+".99",0);this.data.latencyMean=f(a,this.circuitKey+".latencyExecute_mean",0);this.data.latency995=f(a,this.circuitKey+".99.5",0)}}function l(g,e){this.circuitKey=g;this.serviceName=e;this.data={};this.initialized=!1;this.chartDivId=this.threadDivId=void 0;this.refresh=function(c){this.preProcessData(c);this.render();this.updateCircle();this.updateData()};this.render=function(){if(!this.initialized){this.threadDivId=
"THREAD_POOL_"+this.serviceName;var c=b("<div></div>").attr("id",this.threadDivId).addClass("monitor").css({position:"relative"});b("#"+t).append(c);this.addChart(c);this.addTitle(c);this.addData(c);this.initialized=!0}};this.addChart=function(c){this.chartDivId="chart_THREAD_POOL_"+this.serviceName;var a=b("<div></div>").attr("id",this.chartDivId).addClass("chart").css({position:"absolute",top:"0px",left:"0","float":"left",width:"100%",height:"100%"});c.append(a);this.addCircle(this.chartDivId)};
this.addCircle=function(c){d.select("#"+c).append("svg:svg").attr("width","100%").attr("height","100%").append("svg:circle").style("fill","green").attr("cx","30%").attr("cy","30%").attr("r",5)};this.updateCircle=function(){var c=z(this.data.ratePerSecondPerHost);parseInt(c)>parseInt("40%")&&(c="40%");var a=A(this.data.ratePerSecondPerHost);parseInt(a)>parseInt("40%")&&(a="40%");var b=B(this.data.ratePerSecondPerHost);125<parseInt(b)&&(b="125");d.selectAll("#"+this.chartDivId+" circle").transition().duration(400).attr("cy",
a).attr("cx",c).attr("r",b).style("fill",C(this.data.errorPercentage))};this.addTitle=function(c){var a='<p class="name"'+this.serviceName+">"+this.serviceName+"</p>",a=b("<div></div>").css({position:"absolute",top:"0px",width:"100%",height:"15px",opacity:"0.8",background:"white"}).html(a);c.append(a)};this.addData=function(c){var a=b("<div></div>");b(a).css({position:"absolute",top:"15px",opacity:"0.8",background:"white",width:"100%",height:"95%"});c.append(a);c=b("<div></div>").attr("id","chart_THREAD_POOL_"+
this.serviceName+"_monitor_data").addClass("monitor_data");a.append(c)};this.updateData=function(){if(this.initialized){var c=b("#chart_THREAD_POOL_"+this.serviceName+"_monitor_data");c.empty();var a=b("<div></div>").addClass("spacer");c.append(a);this.addRate(c);this.addDataTable(c)}};this.addRate=function(c){var a='<a href="javascript://" title="Total Execution Rate per Second per Reporting Host"class="hystrix-tooltip rate"><span class="smaller">Host: </span><span class="ratePerSecondPerHost">'+
this.data.ratePerSecondPerHost+"</span>/s</a>",a=b("<div></div>").addClass("rate").html(a);c.append(a);a='<a href="javascript://" title="Total Execution Rate per Second for Cluster"class="hystrix-tooltip rate"><span class="smaller">Cluster: </span><span class="ratePerSecond">'+this.data.ratePerSecond+"</span>/s</a>";a=b("<div></div>").addClass("rate").html(a);c.append(a)};this.addDataTable=function(c){var a=b("<div></div>").addClass("spacer");c.append(a);a=b('<div class="tableRow"><div class="cell header left">Active</div><div class="cell data left">'+
this.data.currentActiveCount+' </div><div class="cell header right">Max Active</div><div class="cell data right">'+this.data.rollingMaxActiveThreads+"</div></div>");c.append(a);a=b('<div class="tableRow"><div class="cell header left">Queued</div><div class="cell data left"><span class="value">'+this.data.currentQueueSize+'</span>ms </div><div class="cell header right">Executions</div><div class="cell data right"><span class="value">'+this.data.rollingCountThreadsExecuted+"</span>ms </div></div>");
c.append(a);a=b('<div class="tableRow"><div class="cell header left">Pool Size</div><div class="cell data left"><span class="value">'+this.data.currentPoolSize+'</span>ms</div><div class="cell header right">Queue Size</div><div class="cell data right"><span class="value">'+this.data.propertyValue_queueSizeRejectionThreshold+"</span>ms</div></div>");c.append(a)};this.preProcessData=function(c){this.data={};var a=f(c,this.circuitKey+".reportingHosts",1);this.data.reportingHosts=a;var b=f(c,this.circuitKey+
".propertyValue_queueSizeRejectionThreshold",0);this.data.propertyValue_queueSizeRejectionThreshold=h(b/a);b=f(c,this.circuitKey+".propertyValue_metricsRollingStatisticalWindowInMilliseconds",0);this.data.propertyValue_metricsRollingStatisticalWindowInMilliseconds=h(b/a);var b=this.data.propertyValue_metricsRollingStatisticalWindowInMilliseconds/1E3,g=f(c,this.circuitKey+".rollingCountThreadsExecuted",1);0>g&&(g=0);this.data.ratePerSecond=h(g/b);this.data.ratePerSecondPerHost=h(g/b/a);this.data.currentActiveCount=
f(c,this.circuitKey+".currentActiveCount",1);this.data.rollingMaxActiveThreads=f(c,this.circuitKey+".rollingMaxActiveThreads",1);this.data.currentQueueSize=f(c,this.circuitKey+".currentQueueSize",1);this.data.rollingCountThreadsExecuted=f(c,this.circuitKey+".rollingCountThreadsExecuted",1);this.data.currentPoolSize=f(c,this.circuitKey+".currentPoolSize",1);this.data.propertyValue_queueSizeRejectionThreshold=f(c,this.circuitKey+".propertyValue_queueSizeRejectionThreshold",1)}}function f(b,d,c){if(b[m.GAUGE.type]&&
(b=b[m.GAUGE.type][d]))try{if(b.value){var a=Math.pow(10,4);c=Math.round(b.value*a)/a}}catch(E){}return c}function h(b){b=(Math.round(b*Math.pow(10,1))/Math.pow(10,1)).toString();-1==b.indexOf(".")&&(b+=".0");return b}e.addHystrixDashboard=function(d){q=d;d=b("<div></div>").attr("id","header").html("<h2><span id='title_name'>Hystrix</span></h2>");b(q).append(d);d=b("<div></div>").addClass("hystrix-container");b(q).append(d);var e=b("<div></div>").addClass("row");b(d).append(e);var c=b("<div></div>").addClass("hystrix-menubar");
b(e).append(c);e=b("<div></div>").addClass("title").text("Circuit");b(c).append(e);r="dependencies";c=b("<div></div>").attr("id",r).addClass("row").addClass("dependencies");b(d).append(c);c=b("<div></div>").addClass("spacer");b(d).append(c);e=b("<div></div>").addClass("row");b(d).append(e);c=b("<div></div>").addClass("hystrix-menubar");b(e).append(c);e=b("<div></div>").addClass("title").text("Thread Pools");b(c).append(e);t="dependencyThreadPools";c=b("<div></div>").attr("id",t).addClass("row").addClass("dependencyThreadPools");
b(d).append(c)};e.init=function(){for(var b=0;b<u.length;b++)u[b].render()};e.refresh=function(b){if(q){D(b);for(var d in n)n.hasOwnProperty(d)&&n[d].refresh(b);for(var c in p)p.hasOwnProperty(c)&&p[c].refresh(b)}};e.clear=function(){};Array.prototype.clear=function(){for(;this.length;)this.pop()};var m={COUNTER:{type:"counters"},GAUGE:{type:"gauges"},METER:{type:"meters"},TIMER:{type:"timers"}};Object.freeze(m);Object.freeze(100);var u=[];Object.freeze("40%");Object.freeze("40%");Object.freeze("125");
var x=d.scalePow().exponent(.5).domain([0,400]).range(["5","125"]),w=d.scaleLinear().domain([0,400]).range(["30%","40%"]),v=d.scaleLinear().domain([0,400]).range(["30%","40%"]),y=d.scaleLinear().domain([10,25,40,50]).range(["green","#FFCC00","#FF9900","red"]);Object.freeze(2E3);var B=d.scalePow().exponent(.5).domain([0,2E3]).range(["5","125"]),A=d.scaleLinear().domain([0,2E3]).range(["30%","40%"]),z=d.scaleLinear().domain([0,2E3]).range(["30%","40%"]),C=d.scaleLinear().domain([10,25,40,50]).range(["green",
"#FFCC00","#FF9900","red"]);d.scaleLinear().domain([0,10,35,50]).range(["grey","black","#FF9900","red"]);var q,r,t,n={},p={},D=function(d){for(var e in d)d.hasOwnProperty(e)&&e===m.GAUGE.type&&b.each(d[m.GAUGE.type],function(c,a){if(c.startsWith("gauge.hystrix.HystrixCommand")){var b=c.split(".");6==b.length&&(a=b[0]+"."+b[1]+"."+b[2]+"."+b[3]+"."+b[4],n[a]||(b=new k(a,b[3],b[4]),n[a]=b))}c.startsWith("gauge.hystrix.HystrixThreadPool")&&(a=c.split("."),5==a.length&&(c=a[0]+"."+a[1]+"."+a[2]+"."+a[3],
p[c]||(console.log(a[3]),a=new l(c,a[3]),p[c]=a)))})}})(window.hystrixViewer=window.hystrixViewer||{},jQuery,d3);
