var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(d,a,e){if(null==d)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return d+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,e){d!=Array.prototype&&d!=Object.prototype&&(d[a]=e.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,a,e,l){if(a){e=$jscomp.global;d=d.split(".");for(l=0;l<d.length-1;l++){var m=d[l];m in e||(e[m]={});e=e[m]}d=d[d.length-1];l=e[d];a=a(l);a!=l&&null!=a&&$jscomp.defineProperty(e,d,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("String.prototype.startsWith",function(d){return d?d:function(a,e){var d=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var m=d.length,f=a.length;e=Math.max(0,Math.min(e|0,d.length));for(var k=0;k<f&&e<m;)if(d[e++]!=a[k++])return!1;return k>=f}},"es6-impl","es3");
(function(d,a,e){function l(g,d,c){this.circuitKey=g;this.serviceName=d;this.methodName=c;this.suffix=this.serviceName+"_"+this.methodName;this.initialized=!1;this.circuitDivId="CIRCUIT_"+this.suffix;this.chartDivId="chart_CIRCUIT_"+this.suffix;this.graphDivId="graph_CIRCUIT_"+this.suffix;this.data={};this.graphData=[];this.render=function(){if(!this.initialized){var b=a("<div></div>").attr("id",this.circuitDivId).addClass("monitor").css({position:"relative"});a("#"+t).append(b);this.addChart(b);
this.addTitle(b);this.addData(b);this.addSparkline(b);this.initialized=!0}};this.refresh=function(b){this.preProcessData(b);this.render();this.updateCircle();this.updateData();this.updateSparkline()};this.addChart=function(b){var c=a("<div></div>").attr("id",this.chartDivId).addClass("chart").css({position:"absolute",top:"0px",left:"0","float":"left",width:"100%",height:"100%"});b.append(c);this.addCircle(this.chartDivId)};this.addCircle=function(b){e.select("#"+b).append("svg:svg").attr("width",
"100%").attr("height","100%").append("svg:circle").style("fill","green").attr("cx","30%").attr("cy","30%").attr("r",5)};this.updateCircle=function(){var b=v(this.data.ratePerSecondPerHost);parseInt(b,10)>parseInt("40%",10)&&(b="40%");var a=w(this.data.ratePerSecondPerHost);parseInt(a,10)>parseInt("40%",10)&&(a="40%");var c=x(this.data.ratePerSecondPerHost);125<parseInt(c,10)&&(c="125");e.selectAll("#"+this.chartDivId+" circle").transition().duration(400).attr("cy",a).attr("cx",b).attr("r",c).style("fill",
y(this.data.errorPercentage))};this.addTitle=function(b){var c='<p class="name"'+this.serviceName+"."+this.methodName+">"+this.serviceName+"."+this.methodName+"</p>",c=a("<div></div>").css({position:"absolute",top:"0px",width:"100%",height:"15px",opacity:"0.8",background:"white"}).html(c);b.append(c)};this.addData=function(b){var c=a("<div></div>");a(c).css({position:"absolute",top:"15px",opacity:"0.8",background:"white",width:"100%",height:"95%"});b.append(c);b=a("<div></div>").attr("id",this.chartDivId+
"_monitor_data").addClass("monitor_data");c.append(b)};this.updateData=function(){if(this.initialized){var b=a("#"+this.chartDivId+"_monitor_data");b.empty();this.addCounters(b);this.addRate(b);this.addCircuitStatus(b);this.addDataTable(b);a("#"+this.circuitDivId).attr("rate_value",this.data.ratePerSecond).attr("error_then_volume",this.data.errorThenVolume);a("#"+this.circuitDivId+" a.errorPercentage").css("color",z(this.data.errorPercentage))}};this.addCounters=function(b){var c=a("<div></div>").addClass("counters");
b.append(c);b=a("<div></div>").addClass("cell line").html('<a href="javascript://" title="Error Percentage [Timed-out + Threadpool Rejected + Failure / Total]"class="hystrix-tooltip errorPercentage"><span class="value">'+this.data.errorPercentage+"</span>%</a>");c.append(b);b='<a href="javascript://" title="Timed-out Request Count"class="line hystrix-tooltip timeout"><span class="value">'+this.data.rollingCountTimeout+"</span></a>";var g=this.data.rollingCountThreadPoolRejected?'<a href="javascript://" title="Threadpool Rejected Request Count"class="line hystrix-tooltip rejected"><span class="value">'+
this.data.rollingCountThreadPoolRejected+"</span></a>":'<a href="javascript://" title="Semaphore Rejected Request Count"class="line hystrix-tooltip rejected"><span class="value">'+this.data.rollingCountSemaphoreRejected+"</span></a>";var d='<a href="javascript://" title="Failure Request Count"class="line hystrix-tooltip failure"><span class="value">'+this.data.rollingCountFailure+"</span></a>";b=a("<div></div>").addClass("cell borderRight").html(b+"\n"+g+"\n"+d);c.append(b);b='<a href="javascript://" title="Successful Request Count"class="line hystrix-tooltip success"><span class="value">'+
this.data.rollingCountSuccess+"</span></a>";g='<a href="javascript://" title="Short-circuited Request Count"class="line hystrix-tooltip shortCircuited"><span class="value">'+this.data.rollingCountShortCircuited+"</span></a>";d='<a href="javascript://" title="Bad Request Count"class="line hystrix-tooltip badRequest"><span class="value">'+this.data.rollingCountBadRequests+"</span></a>";b=a("<div></div>").addClass("cell borderRight").html(b+"\n"+g+"\n"+d);c.append(b)};this.addRate=function(b){var c=
'<a href="javascript://" title="Total Request Rate per Second per Reporting Host"class="hystrix-tooltip rate"><span class="smaller">Host: </span><span class="ratePerSecondPerHost">'+this.data.ratePerSecondPerHost+"</span>/s</a>",c=a("<div></div>").addClass("rate").html(c);b.append(c);c='<a href="javascript://" title="Total Request Rate per Second for Cluster"class="hystrix-tooltip rate"><span class="smaller">Cluster: </span><span class="ratePerSecond">'+this.data.ratePerSecond+"</span>/s</a>";c=a("<div></div>").addClass("rate").html(c);
b.append(c)};this.addCircuitStatus=function(b){var c=a("<div></div>").addClass("circuitStatus").html('Circuit <font color="green">Closed</font>');b.append(c)};this.addDataTable=function(b){var c=a("<div></div>").addClass("spacer");b.append(c);c=a('<div class="tableRow"><div class="cell header">Hosts</div><div class="cell data">'+this.data.reportingHosts+' </div><div class="cell header">90th</div><div class="cell data latency90"><span class="value">'+this.data.latency90+"</span>ms </div></div>");b.append(c);
c=a('<div class="tableRow"><div class="cell header">Median</div><div class="cell data latencyMedian"><span class="value">'+this.data.latencyMedian+'</span>ms </div><div class="cell header">99th</div><div class="cell data latency99"><span class="value">'+this.data.latency99+"</span>ms </div></div>");b.append(c);c=a('<div class="tableRow"><div class="cell header">Mean</div><div class="cell data latencyMean"><span class="value">'+this.data.latencyMean+'</span>ms</div><div class="cell header">99.5th</div><div class="cell data latency995"><span class="value">'+
this.data.latency995+"</span>ms</div></div>");b.append(c)};this.addSparkline=function(b){var c=a("<div></div>").attr("id",this.graphDivId).addClass("graph").css({position:"absolute",top:"25px",left:"0","float":"left",width:"140px",height:"62px"});b.append(c);e.select("#"+this.graphDivId).append("svg:svg").attr("width","100%").attr("height","100%").append("svg:path")};this.updateSparkline=function(){var b=(new Date).getTime();for(this.graphData.push({v:parseFloat(this.data.ratePerSecond),t:b});200<
this.graphData.length;)this.graphData.shift();if(1!==this.graphData.length||0!==this.graphData[0].v){1<this.graphData.length&&0===this.graphData[0].v&&0!==this.graphData[1].v&&this.graphData.shift();var c=e.scaleTime().domain([new Date(b-12E4),new Date(b)]).range([0,140]),b=e.min(this.graphData,function(b){return b.v}),a=e.max(this.graphData,function(b){return b.v}),g=e.scaleLinear().domain([b,a]).nice().range([60,0]),d=e.line().x(function(b){return c(new Date(b.t))}).y(function(b){return g(b.v)}).curve(e.curveBasis),
f=this.graphData;e.selectAll("#"+this.graphDivId+" path").attr("d",function(b,c){return d(f)})}};this.preProcessData=function(b){this.data={};var c=f(b,this.circuitKey+".propertyValue_metricsRollingStatisticalWindowInMilliseconds",0)/1E3,a=f(b,this.circuitKey+".requestCount",0);0>a&&(a=0);var g=f(b,this.circuitKey+".reportingHosts",0);this.data.ratePerSecond=k(a/c);this.data.ratePerSecondPerHost=k(a/c/g);this.data.ratePerSecondPerHostDisplay=this.data.ratePerSecondPerHost;this.data.errorPercentage=
f(b,this.circuitKey+".errorPercentage",0);this.data.errorThenVolume=isNaN(this.data.ratePerSecond)?-1:1E8*this.data.errorPercentage+this.data.ratePerSecond;console.log("errorThenVolume: "+this.data.errorThenVolume);this.data.rollingCountTimeout=f(b,this.circuitKey+".rollingCountTimeout",0);c=f(b,this.circuitKey+".rollingCountThreadPoolRejected",-20);-20===c?this.data.rollingCountSemaphoreRejected=f(b,this.circuitKey+".rollingCountSemaphorePoolRejected",0):this.data.rollingCountThreadPoolRejected=
c;this.data.rollingCountFailure=f(b,this.circuitKey+".rollingCountFailure",0);this.data.rollingCountSuccess=f(b,this.circuitKey+".rollingCountSuccess",0);this.data.rollingCountShortCircuited=f(b,this.circuitKey+".rollingCountShortCircuited",0);this.data.rollingCountBadRequests=f(b,this.circuitKey+".rollingCountBadRequests",0);this.data.reportingHosts=f(b,this.circuitKey+".reportingHosts",1);this.data.latency90=f(b,this.circuitKey+".90",0);this.data.latencyMedian=f(b,this.circuitKey+".50",0);this.data.latency99=
f(b,this.circuitKey+".99",0);this.data.latencyMean=f(b,this.circuitKey+".latencyExecute_mean",0);this.data.latency995=f(b,this.circuitKey+".99.5",0)}}function m(g,d){this.circuitKey=g;this.serviceName=d;this.data={};this.initialized=!1;this.threadDivId="THREAD_POOL_"+this.serviceName;this.chartDivId="chart_THREAD_POOL_"+this.serviceName;this.refresh=function(c){this.preProcessData(c);this.render();this.updateCircle();this.updateData()};this.render=function(){if(!this.initialized){var c=a("<div></div>").attr("id",
this.threadDivId).addClass("monitor").css({position:"relative"});a("#"+u).append(c);this.addChart(c);this.addTitle(c);this.addData(c);this.initialized=!0}};this.addChart=function(c){var b=a("<div></div>").attr("id",this.chartDivId).addClass("chart").css({position:"absolute",top:"0px",left:"0","float":"left",width:"100%",height:"100%"});c.append(b);this.addCircle(this.chartDivId)};this.addCircle=function(c){e.select("#"+c).append("svg:svg").attr("width","100%").attr("height","100%").append("svg:circle").style("fill",
"green").attr("cx","30%").attr("cy","30%").attr("r",5)};this.updateCircle=function(){var c=A(this.data.ratePerSecondPerHost);parseInt(c)>parseInt("40%")&&(c="40%");var b=B(this.data.ratePerSecondPerHost);parseInt(b)>parseInt("40%")&&(b="40%");var a=C(this.data.ratePerSecondPerHost);125<parseInt(a)&&(a="125");e.selectAll("#"+this.chartDivId+" circle").transition().duration(400).attr("cy",b).attr("cx",c).attr("r",a).style("fill",D(this.data.errorPercentage))};this.addTitle=function(c){var b='<p class="name"'+
this.serviceName+">"+this.serviceName+"</p>",b=a("<div></div>").css({position:"absolute",top:"0px",width:"100%",height:"15px",opacity:"0.8",background:"white"}).html(b);c.append(b)};this.addData=function(c){var b=a("<div></div>");a(b).css({position:"absolute",top:"15px",opacity:"0.8",background:"white",width:"100%",height:"95%"});c.append(b);c=a("<div></div>").attr("id",this.chartDivId+"_monitor_data").addClass("monitor_data");b.append(c)};this.updateData=function(){if(this.initialized){var c=a("#"+
this.chartDivId+"_monitor_data");c.empty();var b=a("<div></div>").addClass("spacer");c.append(b);this.addRate(c);this.addDataTable(c)}};this.addRate=function(c){var b='<a href="javascript://" title="Total Execution Rate per Second per Reporting Host"class="hystrix-tooltip rate"><span class="smaller">Host: </span><span class="ratePerSecondPerHost">'+this.data.ratePerSecondPerHost+"</span>/s</a>",b=a("<div></div>").addClass("rate").html(b);c.append(b);b='<a href="javascript://" title="Total Execution Rate per Second for Cluster"class="hystrix-tooltip rate"><span class="smaller">Cluster: </span><span class="ratePerSecond">'+
this.data.ratePerSecond+"</span>/s</a>";b=a("<div></div>").addClass("rate").html(b);c.append(b)};this.addDataTable=function(c){var b=a("<div></div>").addClass("spacer");c.append(b);b=a('<div class="tableRow"><div class="cell header left">Active</div><div class="cell data left">'+this.data.currentActiveCount+' </div><div class="cell header right">Max Active</div><div class="cell data right">'+this.data.rollingMaxActiveThreads+"</div></div>");c.append(b);b=a('<div class="tableRow"><div class="cell header left">Queued</div><div class="cell data left"><span class="value">'+
this.data.currentQueueSize+'</span>ms </div><div class="cell header right">Executions</div><div class="cell data right"><span class="value">'+this.data.rollingCountThreadsExecuted+"</span>ms </div></div>");c.append(b);b=a('<div class="tableRow"><div class="cell header left">Pool Size</div><div class="cell data left"><span class="value">'+this.data.currentPoolSize+'</span>ms</div><div class="cell header right">Queue Size</div><div class="cell data right"><span class="value">'+this.data.propertyValue_queueSizeRejectionThreshold+
"</span>ms</div></div>");c.append(b)};this.preProcessData=function(c){this.data={};var b=f(c,this.circuitKey+".reportingHosts",1);this.data.reportingHosts=b;var a=f(c,this.circuitKey+".propertyValue_queueSizeRejectionThreshold",0);this.data.propertyValue_queueSizeRejectionThreshold=k(a/b);a=f(c,this.circuitKey+".propertyValue_metricsRollingStatisticalWindowInMilliseconds",0);this.data.propertyValue_metricsRollingStatisticalWindowInMilliseconds=k(a/b);var a=this.data.propertyValue_metricsRollingStatisticalWindowInMilliseconds/
1E3,g=f(c,this.circuitKey+".rollingCountThreadsExecuted",1);0>g&&(g=0);this.data.ratePerSecond=k(g/a);this.data.ratePerSecondPerHost=k(g/a/b);this.data.currentActiveCount=f(c,this.circuitKey+".currentActiveCount",1);this.data.rollingMaxActiveThreads=f(c,this.circuitKey+".rollingMaxActiveThreads",1);this.data.currentQueueSize=f(c,this.circuitKey+".currentQueueSize",1);this.data.rollingCountThreadsExecuted=f(c,this.circuitKey+".rollingCountThreadsExecuted",1);this.data.currentPoolSize=f(c,this.circuitKey+
".currentPoolSize",1);this.data.propertyValue_queueSizeRejectionThreshold=f(c,this.circuitKey+".propertyValue_queueSizeRejectionThreshold",1)}}function f(a,d,c){if(a[n.GAUGE.type]&&(a=a[n.GAUGE.type][d]))try{if(a.value){var b=Math.pow(10,4);c=Math.round(a.value*b)/b}}catch(F){}return c}function k(a){a=(Math.round(a*Math.pow(10,1))/Math.pow(10,1)).toString();-1==a.indexOf(".")&&(a+=".0");return a}d.addHystrixDashboard=function(g){r=g;g=a("<div></div>").attr("id","streamHeader").html("<h2><span id='title_name'>Hystrix</span></h2>");
a(r).append(g);g=a("<div></div>").addClass("hystrix-container");a(r).append(g);var d=a("<div></div>").addClass("row");a(g).append(d);var c=a("<div></div>").addClass("hystrix-menubar");a(d).append(c);d=a("<div></div>").addClass("title").text("Circuit");a(c).append(d);d=a("<div></div>").addClass("menu_actions").html('Sort: <a href="javascript://" onclick="hystrixViewer.sortAlphabetically();">Alphabetical</a> | <a href="javascript://" onclick="hystrixViewer.sortByLatencyMean();">Mean</a> | <a href="javascript://" onclick="hystrixViewer.sortByLatencyMedian();">Median</a> | <a href="javascript://" onclick="hystrixViewer.sortByLatency90();">90</a> | <a href="javascript://" onclick="hystrixViewer.sortByLatency99();">99</a> | <a href="javascript://" onclick="hystrixViewer.sortByLatency995();">99.5</a> ');
a(c).append(d);d=a("<div></div>").addClass("menu_legend").html('<span class="success">Success</span> | <span class="shortCircuited">Short-Circuited</span> | <span class="badRequest"> Bad Request</span> | <span class="timeout">Timeout</span> | <span class="rejected">Rejected</span> | <span class="failure">Failure</span> | <span class="errorPercentage">Error %</span>');a(c).append(d);t="dependencies";c=a("<div></div>").attr("id",t).addClass("row").addClass("dependencies");a(g).append(c);c=a("<div></div>").addClass("spacer");
a(g).append(c);d=a("<div></div>").addClass("row");a(g).append(d);c=a("<div></div>").addClass("hystrix-menubar");a(d).append(c);d=a("<div></div>").addClass("title").text("Thread Pools");a(c).append(d);u="dependencyThreadPools";c=a("<div></div>").attr("id",u).addClass("row").addClass("dependencyThreadPools");a(g).append(c)};d.init=function(){};d.refresh=function(a){if(r){E(a);for(var d in p)p.hasOwnProperty(d)&&p[d].refresh(a);for(var c in q)q.hasOwnProperty(c)&&q[c].refresh(a)}};d.clear=function(){};
Array.prototype.clear=function(){for(;this.length;)this.pop()};d.sortAlphabetically=function(){var d="asc";"alph_asc"==h&&(d="desc");var e=a("#dependencies div.monitor");h="alph_"+d;e.tsort("p.name",{order:d})};d.sortByLatency90=function(){var a="desc";"lat90_desc"==h&&(a="asc");h="lat90_"+a;this.sortByMetricInDirection(a,".latency90 .value")};d.sortByLatency99=function(){var a="desc";"lat99_desc"==h&&(a="asc");h="lat99_"+a;this.sortByMetricInDirection(a,".latency99 .value")};d.sortByLatency995=function(){var a=
"desc";"lat995_desc"==h&&(a="asc");h="lat995_"+a;this.sortByMetricInDirection(a,".latency995 .value")};d.sortByLatencyMean=function(){var a="desc";"latMean_desc"==h&&(a="asc");h="latMean_"+a;this.sortByMetricInDirection(a,".latencyMean .value")};d.sortByLatencyMedian=function(){var a="desc";"latMedian_desc"==h&&(a="asc");h="latMedian_"+a;this.sortByMetricInDirection(a,".latencyMedian .value")};d.sortByMetricInDirection=function(d,e){a("#dependencies div.monitor").tsort(e,{order:d})};var n={COUNTER:{type:"counters"},
GAUGE:{type:"gauges"},METER:{type:"meters"},TIMER:{type:"timers"}};Object.freeze(n);Object.freeze(100);Object.freeze("40%");Object.freeze("40%");Object.freeze("125");var x=e.scalePow().exponent(.5).domain([0,400]).range(["5","125"]),w=e.scaleLinear().domain([0,400]).range(["30%","40%"]),v=e.scaleLinear().domain([0,400]).range(["30%","40%"]),y=e.scaleLinear().domain([10,25,40,50]).range(["green","#FFCC00","#FF9900","red"]),z=e.scaleLinear().domain([0,10,35,50]).range(["grey","black","#FF9900","red"]);
Object.freeze(2E3);var C=e.scalePow().exponent(.5).domain([0,2E3]).range(["5","125"]),B=e.scaleLinear().domain([0,2E3]).range(["30%","40%"]),A=e.scaleLinear().domain([0,2E3]).range(["30%","40%"]),D=e.scaleLinear().domain([10,25,40,50]).range(["green","#FFCC00","#FF9900","red"]);e.scaleLinear().domain([0,10,35,50]).range(["grey","black","#FF9900","red"]);var r,t,u,p={},q={},h="alph_asc",E=function(d){for(var e in d)d.hasOwnProperty(e)&&e===n.GAUGE.type&&a.each(d[n.GAUGE.type],function(a,b){if(a.startsWith("gauge.hystrix.HystrixCommand")){var c=
a.split(".");6==c.length&&(b=c[0]+"."+c[1]+"."+c[2]+"."+c[3]+"."+c[4],p[b]||(c=new l(b,c[3],c[4]),p[b]=c))}a.startsWith("gauge.hystrix.HystrixThreadPool")&&(b=a.split("."),5==b.length&&(a=b[0]+"."+b[1]+"."+b[2]+"."+b[3],q[a]||(console.log(b[3]),b=new m(a,b[3]),q[a]=b)))})}})(window.hystrixViewer=window.hystrixViewer||{},jQuery,d3);
